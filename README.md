# mScreenshot-WSL
A modified version of [cMardikas/mScreenshot](https://github.com/cMardikas/mScreenshot), adapted for **WSL (Windows Subsystem for Linux)**.  

This script:
- detects HTTP/HTTPS services during an Nmap scan,  
- takes **screenshots** of detected web services,  
- generates an **HTML report** (with services, CVEs and embedded screenshots).  
---

## Requirements

Install required tools (tested with Ubuntu):
```
sudo apt update
sudo apt install -y nmap python3 python3-pip chromium chromium-driver xsltproc wget
python3 -m pip install selenium --break-system-packages
```
## Installation

Download all required files into a working directory:

```
mkdir ~/mscreenshot-wsl && cd ~/mscreenshot-wsl

wget https://raw.githubusercontent.com/argoilves/mscreenshot-wsl/main/http-screenshot.nse
wget https://raw.githubusercontent.com/argoilves/mscreenshot-wsl/main/screenshot.py
wget https://raw.githubusercontent.com/argoilves/mscreenshot-wsl/main/nmap-bootstrap.xsl
wget https://raw.githubusercontent.com/argoilves/mscreenshot-wsl/main/run-scan.sh

chmod +x run-scan.sh
```

## Usage

### Option 1: Interactive script (recommended)

```
./run-scan.sh
```

The script will:
- ask for a target network or IP as an input (e.g. 192.168.1.0/24 or 192.168.1.1),

- run the Nmap scan with screenshot support, save results into ~/mscreenshot-wsl/report-YYYYMMDD-HHMM/, generate an HTML report with embedded screenshots, opens the report automatically in Chrome (on Windows).

### Option 2: Manual run

Create folder and go to that folder:
```
SCAN_DIR=~/mscreenshot-wsl/report-$(date +%Y%m%d-%H%M)
mkdir -p "$SCAN_DIR"
cd "$SCAN_DIR"
```
Scan network:
```
sudo nmap --script=$HOME/mscreenshot-/ -sS -sV -n -v \
  --defeat-rst-ratelimit --host-timeout 600s --stats-every 10s \
  -oA scan 192.168.1.0/24
```
Generate HTML raport:
```
xsltproc -o report.html ~/mscreenshot/nmap-bootstrap.xsl scan.xml
```
To open the report in Chrome (Windows):
```
"/mnt/c/Program Files/Google/Chrome/Application/chrome.exe" "$(wslpath -w report.html)"
```

#### Notes
Screenshots are generated by screenshot.py which is called from http-screenshot.nse. The HTML report is built with nmap-bootstrap-screenshot.xsl. Each scan is stored in its own subfolder (report-YYYYMMDD-HHMM). If Chrome cannot be found in Windows, open report.html manually in your browser.

#### Nmap Examples and Flag Explanations

This section provides detailed explanations for the Nmap flags used in this script, allowing you to customize your scans more effectively. You must be in the correct directory before running these commands.

```
sudo nmap --script=$HOME/mscreenshot-wsl/http-screenshot.nse -sS -sV -n -v \
  --defeat-rst-ratelimit --host-timeout 600s --stats-every 10s \
  -oA scan 192.168.1.0/24
```

`--script`	This is the core of our scan. It specifies the Nmap Scripting Engine (NSE) script to run. In this case, it calls http-screenshot.nse to perform the screenshot function.	
```
--script=$HOME/mscreenshot-wsl/http-screenshot.nse
```
`-sS`	TCP SYN Scan. This is a fast and stealthy scan type. It sends a SYN packet to each target port and waits for a SYN/ACK response to determine if the port is open without completing the full TCP handshake.	
```
-sS
```
`-sV`	Version Detection. This flag attempts to determine the service and version of the applications running on open ports. It's crucial for our script as it helps identify HTTP/HTTPS services.	
```
-sV
```
`-n`	No DNS Resolution. Using this flag tells Nmap not to perform reverse DNS lookups on the target IPs. This significantly speeds up the scan, which is particularly useful for large network ranges.	
```
-n
```
`-v`	Verbose Output. This increases the verbosity level, providing real-time feedback on the scan's progress. It's helpful for monitoring the scan, especially on slow networks.	
```
-v
```
`--defeat-rst-ratelimit`	Some firewalls limit the rate at which they send RST packets. This option helps Nmap avoid being blocked by these limits, ensuring a more accurate scan.	
```
--defeat-rst-ratelimit
```
`--host-timeout`	Sets a maximum amount of time Nmap will spend scanning a single host. If a host takes too long, it will be skipped, preventing the scan from getting stuck on an unresponsive target.	
```
--host-timeout 600s
```
`--stats-every`	Prints a status update every specified amount of time. This provides visibility into the scan's progress without requiring verbose output.	
```
--stats-every 10s
```
`-oA`	Output All Formats. This is a shortcut to save the scan results in three formats: normal (.nmap), XML (.xml), and Grepable (.gnmap). The XML file is what our script uses to generate the HTML report.	
```
-oA scan
```
`192.168.1.0/24`	Target Specification. This is the IP address, host, or network range you want to scan. You can use different formats like a single IP (192.168.1.1), a range (192.168.1.10-20), a subnet (192.168.1.0/24), or a file list (-iL targets.txt).	
```
192.168.1.0/24
```
#### Quick Scan of a Single IP
This is a fast scan focused on common web ports on a specific host.
```
sudo nmap --script=$HOME/mscreenshot-wsl/http-screenshot.nse -sS -sV -n -v \
  --defeat-rst-ratelimit --host-timeout 60s --stats-every 5s \
  -p 80,443,8080 -oA scan 192.168.1.1
```
#### Comprehensive Scan of a Full Network
This command scans all 65,535 TCP ports on an entire network segment. Be aware that this will take a long time to complete.
```
sudo nmap --script=$HOME/mscreenshot-wsl/http-screenshot.nse -sS -sV -n -v \
  --defeat-rst-ratelimit --host-timeout 900s --stats-every 60s \
  -p 1-65535 -oA scan 192.168.1.0/24
```
After running your desired Nmap command, proceed with the final step to generate the HTML report.
