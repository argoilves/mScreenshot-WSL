# mScreenshot-WSL
A modified version of [cMardikas/mScreenshot](https://github.com/cMardikas/mScreenshot), adapted for **WSL (Windows Subsystem for Linux)**.  

This script:
- detects HTTP/HTTPS services during an Nmap scan,  
- takes **screenshots** of detected web services,  
- generates an **HTML report** (with services, CVEs and embedded screenshots).  
---

## Requirements

Install required tools (tested with Ubuntu):
```
sudo apt update
sudo apt install -y nmap python3 python3-pip chromium chromium-driver xsltproc wget
python3 -m pip install selenium --break-system-packages
```
## Installation

Download all required files into a working directory:

```
mkdir ~/mscreenshot-wsl && cd ~/mscreenshot-wsl

wget https://raw.githubusercontent.com/argoilves/mscreenshot-wsl/main/http-screenshot.nse
wget https://raw.githubusercontent.com/argoilves/mscreenshot-wsl/main/screenshot.py
wget https://raw.githubusercontent.com/argoilves/mscreenshot-wsl/main/nmap-bootstrap.xsl
wget https://raw.githubusercontent.com/argoilves/mscreenshot-wsl/main/run-scan.sh

chmod +x run-scan.sh
```

## Usage

### Option 1: Interactive script (recommended)

```
./run-scan.sh
```

The script will:
- ask for a target network or IP as an input (e.g. 192.168.1.0/24 or 192.168.1.1),

- run the Nmap scan with screenshot support, save results into ~/mscreenshot-wsl/report-YYYYMMDD-HHMM/, generate an HTML report with embedded screenshots, opens the report automatically in Chrome (on Windows).

### Option 2: Manual run

Create folder and go to that folder:
```
SCAN_DIR=~/mscreenshot-wsl/report-$(date +%Y%m%d-%H%M)
mkdir -p "$SCAN_DIR"
cd "$SCAN_DIR"
```
Scan network:
```
sudo nmap --script=$HOME/mscreenshot-/ -sS -sV -n -v \
  --defeat-rst-ratelimit --host-timeout 600s --stats-every 10s \
  -oA scan 192.168.1.0/24
```
Generate HTML raport:
```
xsltproc -o report.html ~/mscreenshot/nmap-bootstrap.xsl scan.xml
```
To open the report in Chrome (Windows):
```
"/mnt/c/Program Files/Google/Chrome/Application/chrome.exe" "$(wslpath -w report.html)"
```

### Notes
Screenshots are generated by screenshot.py which is called from http-screenshot.nse. The HTML report is built with nmap-bootstrap-screenshot.xsl. Each scan is stored in its own subfolder (report-YYYYMMDD-HHMM). If Chrome cannot be found in Windows, open report.html manually in your browser.
